<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¨ AI å‰µæ„è‡ªç”±å¯¦é©—å®¤</title>
    <style>
        :root {
            --primary-white: #ffffff;
            --text-primary: #1a1a1a;
            --text-secondary: #666666;
            --text-subtle: #999999;
            --accent-blue: #2563eb;
            --accent-blue-hover: #1d4ed8;
            --surface-light: #f8fafc;
            --border-light: #e2e8f0;
            --shadow-subtle: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
            --shadow-medium: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --danger-red: #dc2626;
            --danger-red-hover: #b91c1c;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: var(--primary-white);
            color: var(--text-primary);
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Inter', sans-serif;
            line-height: 1.6;
            font-weight: 400;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .header {
            padding: 80px 0 50px 0;
            text-align: center;
            border-bottom: 1px solid var(--border-light);
        }

        .title {
            font-size: clamp(3rem, 8vw, 5rem);
            font-weight: 300;
            color: var(--text-primary);
            margin-bottom: 1.5rem;
            letter-spacing: -0.025em;
            line-height: 1.1;
        }

        .subtitle {
            font-size: clamp(1.1rem, 2vw, 1.3rem);
            color: var(--text-secondary);
            margin-bottom: 2rem;
            font-weight: 300;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .status-indicator {
            display: inline-block;
            padding: 0.5rem 1rem;
            border-radius: 12px;
            font-size: 0.9rem;
            font-weight: 500;
            margin-bottom: 2rem;
        }

        .status-local {
            background: #dcfce7;
            color: #166534;
            border: 1px solid #bbf7d0;
        }

        .status-github {
            background: #dbeafe;
            color: #1e40af;
            border: 1px solid #bfdbfe;
        }

        .main-content {
            padding: 80px 0;
        }

        .section-title {
            font-size: clamp(2rem, 5vw, 2.5rem);
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 3rem;
            text-align: center;
            letter-spacing: -0.015em;
        }

        .gallery {
            background: var(--surface-light);
            border-radius: 24px;
            padding: 4rem 3rem;
            border: 1px solid var(--border-light);
            margin-bottom: 4rem;
        }

        .loading {
            text-align: center;
            padding: 4rem;
            color: var(--text-secondary);
        }

        .file-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 2rem;
            margin-top: 3rem;
        }

        .file-card {
            background: var(--primary-white);
            border: 1px solid var(--border-light);
            border-radius: 16px;
            padding: 2rem;
            transition: all 0.3s ease;
            cursor: pointer;
            box-shadow: var(--shadow-subtle);
        }

        .file-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 25px -3px rgb(0 0 0 / 0.1), 0 4px 6px -2px rgb(0 0 0 / 0.05);
            border-color: var(--accent-blue);
        }

        .file-card h3 {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.75rem;
        }

        .file-card p {
            color: var(--text-secondary);
            margin-bottom: 1.5rem;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .card-buttons {
            display: flex;
            gap: 0.75rem;
        }

        .btn {
            border: none;
            border-radius: 12px;
            padding: 0.75rem 1rem;
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn-primary {
            background: var(--accent-blue);
            color: white;
            flex: 1;
        }

        .btn-primary:hover {
            background: var(--accent-blue-hover);
            transform: translateY(-1px);
        }

        .btn-danger {
            background: var(--danger-red);
            color: white;
        }

        .btn-danger:hover:not(.disabled) {
            background: var(--danger-red-hover);
        }

        .btn.disabled {
            background: var(--text-subtle);
            cursor: not-allowed;
            opacity: 0.6;
        }

        .footer {
            border-top: 1px solid var(--border-light);
            padding: 4rem 0;
            text-align: center;
            background: var(--surface-light);
        }

        .footer p {
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }

        .footer a {
            color: var(--accent-blue);
            text-decoration: none;
            font-weight: 500;
        }

        .footer a:hover {
            text-decoration: underline;
        }

        /* Modal æ¨£å¼ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--text-primary);
        }

        .modal-message {
            color: var(--text-secondary);
            margin-bottom: 2rem;
            line-height: 1.6;
        }

        .modal-buttons {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
        }

        .modal-buttons .btn {
            flex: 1;
            min-width: 120px;
            padding: 0.75rem 1.5rem;
        }

        @media (max-width: 768px) {
            .header {
                padding: 60px 0 40px 0;
            }

            .gallery {
                padding: 3rem 2rem;
            }

            .main-content {
                padding: 60px 0;
            }

            .card-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1 class="title">ğŸ¨ AI å‰µæ„è‡ªç”±å¯¦é©—å®¤</h1>
            <p class="subtitle">ç„¡æ¡†æ¶é™åˆ¶ Â· ç´”ç²¹å‰µæ„è¡¨é” Â· ç¨ç«‹ HTML è—è¡“ä½œå“</p>
            <div id="statusIndicator" class="status-indicator">
                <span id="statusText">æª¢æ¸¬é‹è¡Œç’°å¢ƒä¸­...</span>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <section class="gallery">
                <h2 class="section-title">å‰µæ„é¢¨æ ¼ä½œå“é›†</h2>

                <div id="loadingIndicator" class="loading">
                    <p>ğŸ”„ è¼‰å…¥é¢¨æ ¼ä½œå“ä¸­...</p>
                </div>

                <div id="fileGrid" class="file-grid" style="display: none;">
                    <!-- å‹•æ…‹è¼‰å…¥æª”æ¡ˆå¡ç‰‡ -->
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <p>æ¢ç´¢æ›´å¤šå‰µæ„å¯èƒ½æ€§</p>
            <p>
                <a href="#" id="repoLink" target="_blank">
                    ğŸ“ ä¸‹è¼‰å®Œæ•´ç‰ˆåˆ°æœ¬æ©Ÿ (æ”¯æ´æª”æ¡ˆç®¡ç†åŠŸèƒ½)
                </a>
            </p>
            <p style="font-size: 0.9rem; color: var(--text-subtle); margin-top: 1rem;">
                ç›®å‰å…± <span id="fileCount">è¼‰å…¥ä¸­...</span> å€‹å‰µæ„é¢¨æ ¼ Â·
                <span id="envStatus">æª¢æ¸¬ç’°å¢ƒä¸­...</span>
            </p>
        </footer>
    </div>

    <!-- Modal -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <h3 id="modalTitle" class="modal-title"></h3>
            <p id="modalMessage" class="modal-message"></p>
            <div class="modal-buttons">
                <button id="modalCancel" class="btn btn-primary" onclick="closeModal()">é—œé–‰</button>
                <button id="modalConfirm" class="btn btn-danger" style="display: none;">ç¢ºèª</button>
            </div>
        </div>
    </div>

    <script>
        class DesignLaboratory {
            constructor() {
                this.isLocal = this.detectEnvironment();
                this.files = [];
                this.init();
            }

            detectEnvironment() {
                const hostname = window.location.hostname;
                return hostname === 'localhost' ||
                       hostname === '127.0.0.1' ||
                       hostname.includes('192.168.') ||
                       window.location.protocol === 'file:';
            }

            async init() {
                this.updateStatusIndicator();
                this.updateRepositoryLink();
                await this.loadFiles();
                this.renderFiles();
                this.updateFooterStats();
            }

            updateStatusIndicator() {
                const indicator = document.getElementById('statusIndicator');
                const statusText = document.getElementById('statusText');

                if (this.isLocal) {
                    indicator.className = 'status-indicator status-local';
                    statusText.textContent = 'ğŸ  æœ¬æ©Ÿæ¨¡å¼ - æ”¯æ´å®Œæ•´æª”æ¡ˆç®¡ç†åŠŸèƒ½';
                } else {
                    indicator.className = 'status-indicator status-github';
                    statusText.textContent = 'ğŸŒ ç¶²é æ¨¡å¼ - åƒ…æ”¯æ´é è¦½åŠŸèƒ½';
                }
            }

            updateRepositoryLink() {
                const repoLink = document.getElementById('repoLink');
                // å‹•æ…‹è¨­å®š repository é€£çµ - ç”¨æˆ¶å¯ä»¥åœ¨é€™è£¡æ›¿æ›æˆè‡ªå·±çš„ GitHub repo
                const repoUrl = 'https://github.com/Chang-Ming-Huang/design-laboratory-project';
                repoLink.href = repoUrl;
            }

            updateFooterStats() {
                const fileCountEl = document.getElementById('fileCount');
                const envStatusEl = document.getElementById('envStatus');

                fileCountEl.textContent = this.files.length;
                envStatusEl.textContent = this.isLocal ? 'æœ¬æ©Ÿæ¨¡å¼' : 'ç¶²é æ¨¡å¼';
            }

            async loadFiles() {
                try {
                    if (this.isLocal) {
                        // å¾å¾Œç«¯ API è¼‰å…¥æª”æ¡ˆåˆ—è¡¨
                        const response = await fetch('/api/files');
                        if (response.ok) {
                            this.files = await response.json();
                        } else {
                            throw new Error('ç„¡æ³•é€£æ¥åˆ°æœ¬æ©Ÿæœå‹™å™¨');
                        }
                    } else {
                        // å¾é ç”Ÿæˆçš„ manifest è¼‰å…¥æª”æ¡ˆåˆ—è¡¨
                        const response = await fetch('./files-manifest.json');
                        if (response.ok) {
                            const manifest = await response.json();
                            this.files = manifest.files || [];
                        } else {
                            // å¦‚æœæ²’æœ‰ manifestï¼Œä½¿ç”¨å‚™ç”¨æ¸…å–®
                            this.files = await this.getFallbackFileList();
                        }
                    }
                } catch (error) {
                    console.error('è¼‰å…¥æª”æ¡ˆåˆ—è¡¨å¤±æ•—:', error);
                    this.files = await this.getFallbackFileList();
                }
            }

            async getFallbackFileList() {
                // å‚™ç”¨çš„æª”æ¡ˆåˆ—è¡¨ï¼ŒåŸºæ–¼å·²çŸ¥çš„æª”æ¡ˆ
                return [
                    {
                        name: 'modern_architecture_firm.html',
                        title: 'Modern Architecture Firm',
                        description: 'ğŸ—ï¸ ç¾ä»£å»ºç¯‰äº‹å‹™æ‰€ - å°ˆæ¥­æ¥µç°¡ç¾å­¸ï¼Œå‹•æ…‹å»ºç¯‰ç·šæ¢èˆ‡è—åœ–ç¶²æ ¼'
                    },
                    {
                        name: 'creative_agency_portfolio.html',
                        title: 'Creative Agency Portfolio',
                        description: 'ğŸ¯ å‰µæ„ä»£ç†ä½œå“é›† - å”èª¿é…è‰²ç³»çµ±ï¼Œæ©˜è‰²æ¼¸å±¤èˆ‡å’–å•¡è‰²èª¿çš„å°ˆæ¥­å‰µæ„ç¾å­¸'
                    },
                    {
                        name: 'experimental_typography_lab.html',
                        title: 'Experimental Typography Lab',
                        description: 'ğŸ”¤ å¯¦é©—æ€§å­—é«”å¯¦é©—å®¤ - 2025å·¨å­—é«”é©å‘½ï¼Œæˆ²åŠ‡æ€§æ’ç‰ˆèˆ‡äº’å‹•å­—é«”è¨­è¨ˆ'
                    }
                ];
            }

            renderFiles() {
                const loadingIndicator = document.getElementById('loadingIndicator');
                const fileGrid = document.getElementById('fileGrid');

                loadingIndicator.style.display = 'none';
                fileGrid.style.display = 'grid';

                if (this.files.length === 0) {
                    fileGrid.innerHTML = `
                        <div style="grid-column: 1 / -1; text-align: center; padding: 2rem;">
                            <p style="color: var(--text-secondary);">å°šæœªç™¼ç¾ä»»ä½•é¢¨æ ¼æª”æ¡ˆ</p>
                        </div>
                    `;
                    return;
                }

                fileGrid.innerHTML = this.files.map(file => this.createFileCard(file)).join('');

                // æ›´æ–°åº•éƒ¨çµ±è¨ˆè³‡è¨Š
                this.updateFooterStats();
            }

            createFileCard(file) {
                const deleteButton = this.isLocal
                    ? `<button class="btn btn-danger" onclick="laboratory.confirmDelete('${file.name}')">åˆªé™¤</button>`
                    : `<button class="btn btn-danger disabled" onclick="laboratory.showDeleteRestriction()" title="ç¶²é ç‰ˆç„¡æ³•åˆªé™¤æª”æ¡ˆ">ğŸ”’ åˆªé™¤</button>`;

                return `
                    <div class="file-card">
                        <h3>${file.title || this.extractTitle(file.name)}</h3>
                        <p>${file.description || 'ç¨ç«‹ HTML è—è¡“ä½œå“'}</p>
                        <div class="card-buttons">
                            <a href="./prototypes/${file.name}" target="_blank" class="btn btn-primary">é è¦½</a>
                            ${deleteButton}
                        </div>
                    </div>
                `;
            }

            extractTitle(filename) {
                return filename
                    .replace('.html', '')
                    .replace(/_/g, ' ')
                    .replace(/\b\w/g, l => l.toUpperCase());
            }

            async confirmDelete(filename) {
                this.showModal(
                    'ç¢ºèªåˆªé™¤æª”æ¡ˆ',
                    `æ‚¨ç¢ºå®šè¦åˆªé™¤ã€Œ${filename}ã€å—ï¼Ÿ\n\næ­¤æ“ä½œç„¡æ³•å¾©åŸã€‚`,
                    () => this.deleteFile(filename)
                );
            }

            async deleteFile(filename) {
                try {
                    const response = await fetch(`/api/files/${filename}`, {
                        method: 'DELETE'
                    });

                    if (response.ok) {
                        this.showModal('åˆªé™¤æˆåŠŸ', `å·²æˆåŠŸåˆªé™¤ã€Œ${filename}ã€`);
                        // é‡æ–°è¼‰å…¥æª”æ¡ˆåˆ—è¡¨
                        await this.loadFiles();
                        this.renderFiles();
                    } else {
                        throw new Error('åˆªé™¤å¤±æ•—');
                    }
                } catch (error) {
                    this.showModal('åˆªé™¤å¤±æ•—', `ç„¡æ³•åˆªé™¤ã€Œ${filename}ã€\n\néŒ¯èª¤: ${error.message}`);
                }
            }

            showDeleteRestriction() {
                const repoUrl = 'https://github.com/Chang-Ming-Huang/design-laboratory-project';
                this.showModal(
                    'åŠŸèƒ½é™åˆ¶',
                    'ç¶²é ç‰ˆç„¡æ³•åˆªé™¤æª”æ¡ˆã€‚\n\nè«‹ä¸‹è¼‰å®Œæ•´ç‰ˆåˆ°æœ¬æ©Ÿä»¥ä½¿ç”¨å…¨éƒ¨åŠŸèƒ½ã€‚',
                    null,
                    'ä¸‹è¼‰å®Œæ•´ç‰ˆ',
                    () => window.open(repoUrl, '_blank')
                );
            }

            showModal(title, message, onConfirm = null, confirmText = 'ç¢ºèª', onConfirmCallback = null) {
                document.getElementById('modalTitle').textContent = title;
                document.getElementById('modalMessage').textContent = message;

                const confirmBtn = document.getElementById('modalConfirm');
                if (onConfirm || onConfirmCallback) {
                    confirmBtn.style.display = 'block';
                    confirmBtn.textContent = confirmText;
                    confirmBtn.onclick = () => {
                        closeModal();
                        if (onConfirm) onConfirm();
                        if (onConfirmCallback) onConfirmCallback();
                    };
                } else {
                    confirmBtn.style.display = 'none';
                }

                document.getElementById('modal').classList.add('active');
            }
        }

        function closeModal() {
            document.getElementById('modal').classList.remove('active');
        }

        // åˆå§‹åŒ–æ‡‰ç”¨ç¨‹å¼
        let laboratory;
        document.addEventListener('DOMContentLoaded', () => {
            laboratory = new DesignLaboratory();
        });

        // é»æ“Š modal èƒŒæ™¯é—œé–‰
        document.getElementById('modal').addEventListener('click', (e) => {
            if (e.target.id === 'modal') {
                closeModal();
            }
        });
    </script>
</body>
</html>